<!doctype html>
<!--
  Template principal da UI - Captura Unificada
  Estrutura: Sidebar (menu, tema, suporte) + Área de conteúdo (placeholder/loading)
  IDs e classes devem corresponder a ui/js/config/constants.js
-->
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
    <title>Captura Unificada</title>
    <style>
      body { background-color: #0b1220; margin: 0; padding: 0; }
      .app { display: flex; opacity: 0; animation: fadeIn 0.3s forwards; }
      @keyframes fadeIn { to { opacity: 1; } }

      /* Estilo da versão no título */
      .version-tag {
        font-size: 10px;
        opacity: 0.5;
        font-weight: 400;
        margin-left: 5px;
        vertical-align: middle;
        letter-spacing: 0.5px;
      }

      /* Estilo do Badge de Atualização Silenciosa */
      .update-badge {
        display: none; /* Escondido por padrão */
        align-items: center;
        gap: 10px;
        background: rgba(37, 99, 235, 0.1);
        border: 1px solid rgba(37, 99, 235, 0.3);
        color: #60a5fa;
        padding: 10px;
        border-radius: 8px;
        font-size: 11px;
        font-weight: 700;
        margin-bottom: 15px;
        cursor: pointer;
        transition: 0.2s;
        animation: pulseUpdate 2s infinite ease-in-out;
      }

      .update-badge:hover {
        background: rgba(37, 99, 235, 0.2);
        border-color: #2563eb;
        color: #fff;
      }

      .update-badge i { font-size: 14px; }

      @keyframes pulseUpdate {
        0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
        70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
        100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
      }
    </style>
  </head>
  <body class="dark-theme">
    <div class="app">
      <!-- Wrapper: sidebar + botão colapsar (na borda direita do menu) -->
      <div class="sidebar-wrapper" id="sidebar-wrapper">
        <aside class="sidebar" id="sidebar">
          <div class="logo">
            <h2>Captura Unificada<span id="app-version" class="version-tag"></span></h2>
            <span class="logo-sub">Launcher</span>
          </div>

          <!-- Aparência: tema escuro/claro com ícones identificáveis -->
          <div class="theme-section" title="Alternar entre tema escuro e claro">
            <span class="theme-label"><i class="fas fa-circle-half-stroke" aria-hidden="true"></i> Aparência</span>
            <label class="theme-toggle-wrap" aria-label="Tema: escuro (ativado) ou claro">
              <input type="checkbox" class="theme-switch-input" id="theme-toggle" checked aria-label="Tema escuro" />
              <span class="theme-switch-slider">
                <i class="theme-icon theme-icon-moon fas fa-moon" aria-hidden="true"></i>
                <i class="theme-icon theme-icon-sun fas fa-sun" aria-hidden="true"></i>
              </span>
            </label>
          </div>

          <!-- Indicador de carregamento da página (URL) – compacto e animado -->
          <div id="content-loading-bar" class="content-loading-bar hidden" aria-hidden="true" title="Página carregando">
            <span class="content-loading-dot"></span>
            <span class="content-loading-dot"></span>
            <span class="content-loading-dot"></span>
            <span class="content-loading-label">Carregando</span>
          </div>

          <nav class="menu">
            <section class="menu-group">
              <h3 class="menu-group-title">Sistemas Integrados</h3>
              <div class="system-item">
                <button class="menu-btn" id="captura">
                  <span><i class="fas fa-globe"></i><span class="btn-label">CapturaWeb</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu1" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu1">
                  <button class="btn-action btn-action-featured" data-action="reiniciar-servico-hardware"><i class="fas fa-microchip"></i>Reiniciar Serviço</button>
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
              <div class="system-item">
                <button class="menu-btn" id="smart">
                  <span><i class="fas fa-file-invoice"></i><span class="btn-label">SMART (CIN)</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu2" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu2">
                  <button class="btn-action btn-action-featured" data-action="reiniciar-bcc"><i class="fas fa-plug-circle-bolt"></i>Reiniciar BCC</button>
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
              <div class="system-item">
                <button class="menu-btn" id="atende" title="Abre em janela separada. Clique de novo para trazer a janela à frente.">
                  <span><i class="fas fa-ticket atende-icon"></i><span class="btn-label">Atende</span></span>
                  <span class="atende-window-tag">ABERTO</span>
                  <span class="dots" data-menu="menu7" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu7">
                  <button class="btn-atende-config" id="atende-config-btn"><i class="fas fa-cog"></i> Configurar endereço</button>
                  <button class="btn-reload" data-reload-target="atende"><i class="fas fa-redo"></i> Reiniciar página</button>
                </div>
              </div>
            </section>
            <section class="menu-group">
              <h3 class="menu-group-title">Outros Sistemas</h3>
              <div class="system-item">
                <button class="menu-btn" id="validacao">
                  <span><i class="fas fa-fingerprint"></i><span class="btn-label">Validação</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu4" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu4">
                  <button class="btn-action btn-action-featured" data-action="reiniciar-validacao"><i class="fas fa-arrows-rotate"></i>Reiniciar Validação</button>
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
              <div class="system-item">
                <button class="menu-btn" id="doc-avulsos">
                  <span><i class="fas fa-archive"></i><span class="btn-label">Doc Avulso (Antigo)</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu3" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu3">
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
              <div class="system-item">
                <button class="menu-btn" id="ponto-valid">
                  <span><i class="fas fa-user-clock"></i><span class="btn-label">Ponto Valid</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu5" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu5">
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
              <div class="system-item">
                <button class="menu-btn" id="ponto-renova">
                  <span><i class="fas fa-clock-rotate-left"></i><span class="btn-label">Ponto Renova</span></span>
                  <span class="active-tag">ATIVO</span>
                  <span class="dots" data-menu="menu6" title="Mais opções"><i class="fas fa-ellipsis-vertical" aria-hidden="true"></i></span>
                </button>
                <div class="dropdown" id="menu6">
                  <button class="btn-reload"><i class="fas fa-redo"></i> Reiniciar página</button>
                  <button class="btn-cache"><i class="fas fa-broom"></i> Limpar cache</button>
                </div>
              </div>
            </section>
          </nav>

          <div class="status-box">
          <div id="update-indicator" class="update-badge" title="Clique para reiniciar e aplicar agora">
            <i class="fas fa-arrow-up-from-bracket"></i>
            <span>ATUALIZAÇÃO PRONTA</span>
          </div>

          <div class="support-card">
            <div class="support-header">
              <i class="fas fa-headset"></i>
              <span class="support-title">Suporte Técnico</span>
            </div>
            <div class="support-content">
              <p>Informe os dados abaixo para nossa equipe.</p>
            </div>
          </div>

          <div class="pc-info">
            <div class="info-item"><i class="fas fa-desktop"></i><div class="text"><strong>Host</strong><span id="hostname">---</span></div></div>
            <div class="info-item"><i class="fas fa-network-wired"></i><div class="text"><strong>IP</strong><span id="ip">---</span></div></div>
            <div class="info-item"><i class="fas fa-id-card-clip"></i><div class="text"><strong>AnyDesk</strong><span id="anydesk" class="anydesk-id">---</span></div></div>
          </div>

          <div class="sidebar-footer">
            <div class="copyright-entity">@ Consórcio Bahia Digital - 2026</div>
          </div>
        </div>
      </aside>
        <button type="button" class="collapse-btn" id="toggle-sidebar" title="Recolher menu" aria-label="Recolher ou expandir barra lateral">
          <i class="fas fa-angles-left" id="toggle-icon" aria-hidden="true"></i>
        </button>
      </div>

      <!-- Modal: Configurar endereço IP do Atende (salvo em C:/TOOLS) -->
      <div id="atende-modal" class="modal-overlay hidden">
        <div class="modal-atende">
          <h3><i class="fas fa-headset"></i> Configurar Atende</h3>
          <p class="modal-desc">Informe o endereço IP (ex: 192.168.1.100) ou URL completa para teste. O arquivo será salvo em C:\TOOLS.</p>
          <input type="text" id="atende-input" placeholder="Ex: 192.168.1.100 ou https://www.google.com" class="modal-input" />
          <div class="modal-buttons">
            <button type="button" id="atende-cancel" class="btn-modal-cancel">Cancelar</button>
            <button type="button" id="atende-save" class="btn-modal-save"><i class="fas fa-save"></i> Salvar e Abrir</button>
          </div>
        </div>
      </div>

      <!-- ÁREA DE CONTEÚDO: Placeholder, loading do launcher, barra de carregamento da URL e view do sistema -->
      <main class="content">
        <div id="placeholder" class="placeholder">
          <div class="placeholder-container">
            <i class="fas fa-display"></i>
            <h2>Aguardando seleção</h2>
            <p>Escolha um sistema na barra lateral.</p>
          </div>
        </div>

        <div id="loading" class="hidden">
          <div class="spinner"></div>
          <p>Trocando sistema...</p>
        </div>
      </main>
    </div>
    <script type="module" src="app.js"></script>
  </body>
</html>